/# Project Context

Reportador
Reportes de Marketing Digital Inteligentes

ğŸ¯ Â¿QuÃ© es Reportador?
Una aplicaciÃ³n web que genera reportes profesionales de campaÃ±as de marketing desde BigQuery en menos de 3 minutos, eliminando el desarrollo manual y el consumo de recursos tÃ©cnicos.

âš¡ CaracterÃ­sticas Principales
SelecciÃ³n Inteligente de Fechas

Calendario que solo muestra dÃ­as donde las campaÃ±as estuvieron activas
Preview de mÃ©tricas en tiempo real antes de generar
ValidaciÃ³n automÃ¡tica de disponibilidad de datos

Comparaciones Avanzadas

CampaÃ±as vs CampaÃ±as: Rendimiento lado a lado
PerÃ­odos vs PerÃ­odos: Misma campaÃ±a en diferentes fechas
Reportes Unificados: MÃºltiples campaÃ±as en un solo documento

ConfiguraciÃ³n Visual

MÃ©tricas drag & drop para personalizar columnas
Templates reutilizables con lÃ³gica temporal
Export a PDF profesional y Excel


ğŸ“Š Para QuiÃ©n

Marketing Managers: Reportes ejecutivos sin depender de desarrollo
Agencias: Reportes client-ready en minutos, no horas
Analistas: Comparaciones complejas sin SQL manual


ğŸš€ Beneficio Principal
Antes: 3+ horas de desarrollo + recursos tÃ©cnicos + posibles errores
DespuÃ©s: 3 minutos de configuraciÃ³n visual + PDF listo para compartir
## Project Description
Flujo Principal Actualizado
Paso 1: SelecciÃ³n de Plataforma
Mantiene diseÃ±o actual
Paso 2: Tipo de Reporte

Cards con opciones:

ğŸ“Š "Reporte Simple"
âš–ï¸ "Comparar CampaÃ±as"
ğŸ“… "Comparar PerÃ­odos"



Paso 3: SelecciÃ³n de Ad Accounts
Mantiene funcionalidad actual
Paso 4A: SelecciÃ³n de CampaÃ±as (Reporte Simple)

UI Mejorada: Checkboxes mÃºltiples con nueva funcionalidad
Nueva OpciÃ³n: Toggle al final de la lista

ğŸ”„ "Unificar campaÃ±as" â†’ Un solo reporte consolidado
ğŸ“‹ "Reportes separados" â†’ Un PDF por cada campaÃ±a seleccionada


Preview: Contador dinÃ¡mico "3 campaÃ±as â†’ 1 reporte unificado" o "3 campaÃ±as â†’ 3 reportes separados"

Paso 4B: Comparar CampaÃ±as

UI: Dos selectores lado a lado "CampaÃ±a A" vs "CampaÃ±a B"
RestricciÃ³n: Solo una campaÃ±a por lado (no mÃºltiples)

Paso 4C: Comparar PerÃ­odos

UI: Un selector de campaÃ±a Ãºnica
Siguiente: Directo a selecciÃ³n de perÃ­odos duales

Paso 5: SelecciÃ³n de AdSets

Para Unificadas: Lista consolidada de todos los adsets de campaÃ±as seleccionadas
Para Separadas: AgrupaciÃ³n por campaÃ±a con expand/collapse
Para Comparaciones: SegÃºn corresponda al tipo

NUEVO: Paso 6 - Selector de Fechas Inteligente
Layout Principal

Calendario Visual: Ocupando 70% de la pantalla
Panel Lateral: 30% con informaciÃ³n contextual y controles

Estados del Calendario

ğŸŸ¢ Verde: CampaÃ±a activa + preview de mÃ©tricas en hover
ğŸ”´ Rojo: CampaÃ±a inactiva (no clickeable, con patrÃ³n diagonal)
âšª Gris: Fuera de rango de existencia
ğŸ”µ Azul: DÃ­as seleccionados por usuario
âš ï¸ Amarillo con warning: DÃ­as con datos limitados

Panel Lateral - InformaciÃ³n Contextual
ğŸ“Š RESUMEN DE CAMPAÃ‘A
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "Summer Sale 2024"                  â”‚
â”‚ Activa: 15 May - 30 Jun (45 dÃ­as)   â”‚
â”‚ Datos disponibles: 42 dÃ­as          â”‚
â”‚ Pausas detectadas: 3-5 May, 20 May  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ˆ PREVIEW DE SELECCIÃ“N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—“ 12 dÃ­as seleccionados             â”‚
â”‚ ğŸ“Š ~15,247 impresiones              â”‚
â”‚ ğŸ’° ~$2,340 spend                   â”‚
â”‚ ğŸ¯ ~847 clics                      â”‚
â”‚ âš¡ Datos completos: 12/12 dÃ­as      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Controles Inteligentes

Shortcuts:

"Todos los dÃ­as activos" (auto-filtra rojos)
"Ãšltima semana completa"
"Mejor semana" (mayor volumen)


ValidaciÃ³n en Tiempo Real:

Al seleccionar rango con dÃ­as rojos: "âš ï¸ 3 dÃ­as inactivos filtrados automÃ¡ticamente"
Contador se actualiza instantÃ¡neamente



Para Comparar PerÃ­odos

Dos calendarios side-by-side
ValidaciÃ³n AutomÃ¡tica:

PerÃ­odos equivalentes: "PerÃ­odo A: 7 dÃ­as â†’ PerÃ­odo B debe ser 7 dÃ­as"
No solapamiento: DÃ­as ya usados en A aparecen tenue en B
Sugerencias automÃ¡ticas: "Semana equivalente mes anterior" (auto-selecciona)



NUEVO: Paso 7 - ConfiguraciÃ³n de MÃ©tricas Drag & Drop
Layout de Tres Columnas
Columna 1: MÃ©tricas Disponibles (30%)
ğŸ“Š PERFORMANCE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [CTR]          â”‚ â† Casillas arrastrables
â”‚ [CPC]          â”‚
â”‚ [CPM]          â”‚  
â”‚ [ROAS]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ˆ VOLUMEN  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Impressions]  â”‚
â”‚ [Clicks]       â”‚
â”‚ [Conversions]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’° COSTOS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Spend]        â”‚
â”‚ [Cost per Result] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Columna 2: ConfiguraciÃ³n del Reporte (40%)
ğŸ— TU REPORTE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Arrastra mÃ©tricas aquÃ­          â”‚
â”‚                                 â”‚
â”‚ [Impressions] [ğŸ”„] [âŒ]         â”‚ â† Reordenable
â”‚ [Clicks] [ğŸ”„] [âŒ]              â”‚
â”‚ [Spend] [ğŸ”„] [âŒ]               â”‚
â”‚                                 â”‚
â”‚ + Zona de drop activa           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Columna 3: Preview en Tiempo Real (30%)
ğŸ“‹ PREVIEW
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Campaign | Impressions | Clicks â”‚
â”‚ Summer   |    1,247   |   84   â”‚
â”‚ Q4 Lead  |      892   |   23   â”‚
â”‚                                 â”‚
â”‚ âš¡ Estimado: 1,340 filas        â”‚
â”‚ ğŸ“„ TamaÃ±o PDF: ~45 pÃ¡ginas     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Micro-interacciones

Drag feedback: Casilla se eleva, zona de drop se resalta
Reordenamiento: Drag vertical dentro de la columna configuraciÃ³n
Auto-preview: ActualizaciÃ³n instantÃ¡nea al agregar/quitar mÃ©tricas
ValidaciÃ³n: MÃ­nimo 3 mÃ©tricas requeridas, mÃ¡ximo 15 para PDF legible

Paso 8: GeneraciÃ³n y Preview Final
Resumen Ejecutivo
ğŸ“‹ RESUMEN DE TU REPORTE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Tipo: Comparar PerÃ­odos                         â”‚
â”‚ CampaÃ±a: "Summer Sale 2024"                     â”‚
â”‚ PerÃ­odo A: 1-7 Jun (7 dÃ­as activos)            â”‚
â”‚ PerÃ­odo B: 1-7 May (7 dÃ­as activos)            â”‚
â”‚ MÃ©tricas: 6 seleccionadas                       â”‚
â”‚ Estimado: 847 filas â†’ PDF de ~23 pÃ¡ginas       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Opciones de GeneraciÃ³n

PDF Ejecutivo: Con grÃ¡ficos comparativos automÃ¡ticos
PDF Detallado: Solo tablas de datos
Excel: Para anÃ¡lisis posterior

Templates Inteligentes

Auto-sugerencia de nombre: "ComparaciÃ³n Summer Sale Jun vs May"
Guardar lÃ³gica: "Comparar [campaÃ±a] Ãºltimos 7 dÃ­as vs 7 dÃ­as hace 1 mes"

Casos Especiales UX
Multiple CampaÃ±as Unificadas

Preview combinado: Muestra mÃ©tricas agregadas de todas las campaÃ±as
Fechas inteligentes: Solo muestra dÃ­as donde AL MENOS una campaÃ±a estuvo activa
Advertencia: "Campaign X no tiene datos en 3 de los dÃ­as seleccionados"

Reportes Separados

Preview mÃºltiple: Mini-previews por cada campaÃ±a
ValidaciÃ³n individual: Cada campaÃ±a valida sus propias fechas
GeneraciÃ³n: "Generando 3 PDFs... (1/3 completado)"
## Technology Stack
<!-- List the main technologies, frameworks, and languages you plan to use -->
- Frontend: 
- Backend: 
- Database: 
- Other tools: 

## Architecture Overview
1. Paso a Paso del Aspecto LÃ³gico del Proyecto
Arquitectura de Datos
Paso 1: ConexiÃ³n a BigQuery

Establecer conexiÃ³n autenticada con BigQuery
Definir esquemas de tablas para cada plataforma (Facebook Ads, Google Ads, TikTok Ads)
Implementar pool de conexiones para optimizar performance

Paso 2: JerarquÃ­a de Consultas Progresivas

Consulta Base: Seleccionar plataforma â†’ obtener Ad Accounts disponibles
Consulta Nivel 2: Filtrar por Ad Accounts seleccionados â†’ obtener Campaign IDs (aplicar filtro de fecha aquÃ­)
Consulta Nivel 3: Filtrar por Campaigns â†’ obtener Ad Sets
Consulta Final: Con jerarquÃ­a completa â†’ obtener todas las mÃ©tricas solicitadas

Paso 3: OptimizaciÃ³n de Consultas

Implementar filtrado temporal desde consulta nivel 2 para reducir volumen de datos
Usar consultas preparadas para evitar SQL injection
Implementar cachÃ© temporal para consultas repetitivas
PaginaciÃ³n en resultados grandes

Paso 4: Procesamiento de Datos

ValidaciÃ³n de integridad de datos recibidos
NormalizaciÃ³n de mÃ©tricas entre plataformas
CÃ¡lculos derivados (ROAS, CTR, etc.)
Formateo segÃºn configuraciÃ³n del usuario

Paso 5: GeneraciÃ³n de Reportes

Compilar datos segÃºn selecciones del usuario
Exportar a formatos mÃºltiples (CSV, Excel, PDF)
Guardar configuraciÃ³n como template reutilizable

2. Paso a Paso del Aspecto UX del Proyecto
Flujo de Usuario (Wizard de 6 Pasos)
Paso 1: SelecciÃ³n de Plataforma

UI: Cards visuales con logos de plataformas
UX: SelecciÃ³n Ãºnica, descripciÃ³n breve de cada plataforma
Estado: BotÃ³n "Siguiente" se activa solo tras selecciÃ³n
Feedback: Highlighting visual de la plataforma seleccionada

Paso 2: SelecciÃ³n de Ad Accounts

UI: Lista con checkboxes mÃºltiples + buscador
UX:

"Seleccionar todos/Deseleccionar todos"
Indicadores de estado (activo/inactivo) con colores
Contador de seleccionados


Loading: Spinner mientras consulta BigQuery
Validation: MÃ­nimo 1 account seleccionado

Paso 3: SelecciÃ³n de CampaÃ±as

UI: Lista jerÃ¡rquica agrupada por Ad Account
UX:

Expand/collapse por account
Filtros: status, tipo de campaÃ±a
"Seleccionar todas las activas" shortcut
Breadcrumb visual de selecciones


Auto-load: Se ejecuta automÃ¡ticamente al seleccionar accounts

Paso 4: SelecciÃ³n de Ad Sets

UI: Vista de Ã¡rbol expandible (Account > Campaign > Ad Sets)
UX:

SelecciÃ³n en cascada (campaign selecciona todos sus ad sets)
Checkboxes tri-state (checked/unchecked/indeterminate)
Filtros por performance, budget, status
Contador total de ad sets seleccionados



Paso 5: ConfiguraciÃ³n de MÃ©tricas y Fechas

UI: Layout de dos columnas
UX MÃ©tricas:

Drag & drop para reordenar columnas
Checkboxes agrupados por categorÃ­a
Preview de estructura del reporte


UX Fechas:

Date picker con rangos predefinidos
ValidaciÃ³n de rangos lÃ³gicos
Estimador de volumen de datos



Paso 6: PrevisualizaciÃ³n y GeneraciÃ³n

UI: Resumen ejecutivo + preview de datos
UX:

Resumen de todas las selecciones
Estimado de filas resultado
OpciÃ³n "Guardar como template"
BotÃ³n CTA prominente "Generar Reporte"



Consideraciones UX Adicionales

Progress indicator: Stepper visual mostrando paso actual
Estado persistente: localStorage para mantener selecciones
Error handling: Mensajes claros para errores de conexiÃ³n/datos
Responsive design: Adaptable a mÃ³vil/tablet
Accessibility: ARIA labels, navegaciÃ³n por teclado

ecuentemente los usuarios necesitan reportes en tiempo real vs. datos del dÃ­a anterior?


## Key Requirements
<!-- List the main functional and non-functional requirements -->

Sobre Funcionalidad:
4. Â¿Los usuarios necesitan comparar datos entre diferentes plataformas en un mismo reporte?
5. Â¿Planeas incluir funcionalidades de alertas automÃ¡ticas cuando ciertas mÃ©tricas superen thresholds?
6. Â¿Los reportes necesitan incluir visualizaciones (grÃ¡ficos) o solo datos tabulares?
Sobre Experiencia de Usuario:
7. Â¿Los usuarios tÃ­picamente generan reportes similares repetidamente? (esto justificarÃ­a mÃ¡s el sistema de templates)
8. Â¿Necesitas diferentes niveles de acceso? (admin puede ver todas las cuentas, usuario solo las suyas)
9. Â¿Los reportes se compartirÃ¡n con stakeholders externos que no usan la plataforma?
Sobre IntegraciÃ³n:
10. Â¿Este reportador se integrarÃ¡ con otras herramientas internas existentes?
11. Â¿Necesitas APIs para que otros sistemas consuman estos reportes?
Â¿CuÃ¡les de estos aspectos consideras mÃ¡s crÃ­ticos para tu caso de uso especÃ­fico?

## Development Environment Setup
<!-- Describe how to set up the development environment -->

My pc, local run , VUE framework and bigquery functions
## Build and Deployment
<!-- Describe build processes, testing, and deployment procedures -->
Deployment on netlify

## External Dependencies
<!-- List any external APIs, services, or third-party integrations -->

Bigquery structured as follows:

# Unified Campaign Table - Complete Documentation
Table Purpose
The unified_data table consolidates campaign performance data from Facebook, Google, and TikTok into a single, normalized structure. It transforms platform-specific data formats into a consistent long format for cross-platform analysis and reporting.
Table Schema
sqlCREATE TABLE unified_data (
  date DATE,                    -- Campaign performance date
  campaign STRING,              -- Campaign name
  account STRING,               -- Platform account ID (matches clients_master.accounts.id)
  account_name STRING,          -- Human-readable account name
  platform STRING,              -- Advertising platform (facebook, google, tiktok)
  team STRING,                  -- Team name (from clients_master join)
  metric STRING,                -- Performance metric name
  value FLOAT64,                -- Metric value
  last_updated TIMESTAMP        -- Record creation timestamp
)
PARTITION BY date
CLUSTER BY team, metric;
Data Architecture

Long format design: Each row represents one metric value for a specific campaign/account/date
Date partitioned: Optimized for time-based queries
Clustered by team and metric: Fast filtering on these dimensions
Cross-platform normalization: Different platform APIs unified into consistent structure
Platform identification: Explicit platform labeling eliminates need for joins
Daily refresh: Automated population via scheduled queries

Available Fields
Core Dimensions
FieldTypeDescriptionExampledateDATECampaign performance date2025-07-29campaignSTRINGCampaign name from platform"AR_Purchase_Rmkt_TikTok_Video"accountSTRINGPlatform account identifier"204962684277968"account_nameSTRINGHuman-readable account name"Flux IT"platformSTRINGAdvertising platform"facebook", "google", "tiktok"teamSTRINGTeam managing the account"TimBeta"last_updatedTIMESTAMPWhen record was created2025-07-30 08:15:23 UTC
Metric Dimension
FieldTypeDescriptionmetricSTRINGPerformance metric name (see available metrics below)valueFLOAT64Numeric value for the metric
Available Metrics
ğŸ”¥ Universal Metrics (All Platforms)
Core performance indicators available across Facebook, Google, and TikTok
MetricDescriptionUnitPlatform CoveragecostCampaign spend/investmentCurrency unitsFacebook, Google, TikTokclicksUser clicks/interactionsCountFacebook, Google, TikTokimpressionsAd views/displaysCountFacebook, Google, TikTok
ğŸ“± Facebook-Specific Metrics
Rich engagement and social interaction data
Reach & Frequency
MetricDescriptionUnitreachUnique users who saw adsCountfrequencyAverage times user saw adRatio
Engagement Metrics
MetricDescriptionUnitinline_link_clicksClicks on ad linksCountinline_post_engagementTotal post interactions (likes, comments, shares)Count
Video Metrics (Facebook Format)
MetricDescriptionUnitvideo_viewsTotal video viewsCountvideo_views_25Videos watched to 25% completionCountvideo_views_50Videos watched to 50% completionCountvideo_views_75Videos watched to 75% completionCountvideo_views_100Videos watched to 100% completionCount
Conversion Metrics (Facebook)
MetricDescriptionUnitpurchasesPurchase conversionsCountrevenueRevenue attributed to campaignsCurrency units
ğŸµ TikTok-Specific Metrics
Video-first platform engagement indicators
Video Engagement
MetricDescriptionUnitvideo_viewsTotal video views (TikTok format)Countvideo_play_actionsVideo play button clicksCountvideo_watched_2_sVideos watched for 2+ secondsCount
Video Completion (TikTok Format)
MetricDescriptionUnitvideo_views_p_25Videos watched to 25% completionCountvideo_views_p_50Videos watched to 50% completionCountvideo_views_p_75Videos watched to 75% completionCountvideo_views_p_100Videos watched to 100% completionCount
Conversion Metrics (TikTok)
MetricDescriptionUnitpurchasesPurchase conversionsCountpurchases_valueRevenue from purchasesCurrency units
ğŸ” Google-Specific Metrics
Search and display advertising performance
MetricDescriptionUnitconversionsConversion actions completedCount
Data Sources & Population
Source Routines

Facebook: facebook_ads_airbyte.campaign_basic_stats(account_ids_param, start_date_param)
Google: google_ads.campaign_basic_stats(customer_ids_param, start_date_param)
TikTok: tiktok_ads_fivetran.ad_basic_stats(customer_ids_param, start_date_param) (aggregated to campaign level)

Population Process

Platform-specific CTEs extract and transform data from each advertising platform
Account filtering uses clients_master.accounts to determine which accounts to process per platform
Data transformation converts wide format (multiple metric columns) to long format (metric/value pairs)
Platform identification adds explicit platform labels ('facebook', 'google', 'tiktok')
Union operation combines all platforms into single dataset
Team assignment joins with clients_master.accounts to add team information
Data insertion populates the unified table with normalized structure

Daily Transformation Flow
Facebook API â†’ campaign_basic_stats() â†’ facebook_transformed CTE
Google API â†’ campaign_basic_stats() â†’ google_transformed CTE  
TikTok API â†’ ad_basic_stats() â†’ tiktok_aggregated â†’ tiktok_transformed CTE
                                     â†“
                              all_platforms CTE (UNION ALL)
                                     â†“
                              unpivoted CTE (metrics â†’ rows)
                                     â†“
                              Final INSERT (+ team join)
Query Optimization Guidelines
Performance Best Practices
sql-- âœ… GOOD: Filter by date first (leverages partitioning)
SELECT * FROM unified_data 
WHERE date >= '2025-07-01'
  AND team = 'TimBeta'
  AND platform = 'facebook'
  AND metric = 'cost';

-- âœ… GOOD: Use clustered fields in WHERE clause
SELECT * FROM unified_data 
WHERE team IN ('TeamA', 'TeamB')
  AND metric IN ('cost', 'clicks')
  AND platform = 'tiktok';

-- âœ… GOOD: Platform-specific analysis without joins
SELECT platform, SUM(value) as total_cost
FROM unified_data
WHERE metric = 'cost' AND date >= '2025-07-01'
GROUP BY platform;

-- âŒ AVOID: Scanning entire table without date filter
SELECT * FROM unified_data 
WHERE campaign LIKE '%Brand%';
Common Query Patterns
Convert Long Format to Wide Format
sqlSELECT 
  date, campaign, account_name, platform, team,
  SUM(CASE WHEN metric = 'cost' THEN value END) as cost,
  SUM(CASE WHEN metric = 'clicks' THEN value END) as clicks,
  SUM(CASE WHEN metric = 'impressions' THEN value END) as impressions
FROM unified_data
WHERE date >= '2025-07-01'
GROUP BY date, campaign, account_name, platform, team;
Time Series Analysis
sqlSELECT 
  date,
  platform,
  metric,
  SUM(value) as daily_total
FROM unified_data
WHERE metric = 'cost'
  AND date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
GROUP BY date, platform, metric
ORDER BY date, platform;
Cross-Platform Comparison (Direct)
sql-- Direct platform comparison without joins
SELECT 
  platform,
  metric,
  SUM(value) as total_value
FROM unified_data
WHERE date >= '2025-07-01'
  AND metric IN ('cost', 'clicks', 'impressions')
GROUP BY platform, metric
ORDER BY platform, metric;
Platform-Specific Analysis Examples
Facebook Video Funnel Analysis
sqlSELECT 
  campaign,
  account_name,
  SUM(CASE WHEN metric = 'video_views' THEN value END) as total_views,
  SUM(CASE WHEN metric = 'video_views_100' THEN value END) as complete_views,
  SUM(CASE WHEN metric = 'video_views_100' THEN value END) / 
  SUM(CASE WHEN metric = 'video_views' THEN value END) * 100 as completion_rate
FROM unified_data
WHERE platform = 'facebook'
  AND metric LIKE 'video_views%'
  AND metric NOT LIKE '%_p_%'  -- Exclude TikTok format
GROUP BY campaign, account_name;
TikTok Engagement Analysis
sqlSELECT 
  campaign,
  account_name,
  SUM(CASE WHEN metric = 'video_play_actions' THEN value END) as play_actions,
  SUM(CASE WHEN metric = 'video_watched_2_s' THEN value END) as watched_2s,
  SUM(CASE WHEN metric = 'video_views_p_100' THEN value END) as completed
FROM unified_data
WHERE platform = 'tiktok'
  AND metric IN ('video_play_actions', 'video_watched_2_s', 'video_views_p_100')
GROUP BY campaign, account_name;
Cross-Platform Cost Efficiency
sqlSELECT 
  platform,
  SUM(CASE WHEN metric = 'cost' THEN value END) / 
  SUM(CASE WHEN metric = 'clicks' THEN value END) as cost_per_click,
  SUM(CASE WHEN metric = 'cost' THEN value END) / 
  SUM(CASE WHEN metric = 'impressions' THEN value END) * 1000 as cpm
FROM unified_data
WHERE date >= DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY)
  AND metric IN ('cost', 'clicks', 'impressions')
GROUP BY platform
ORDER BY cost_per_click;
Data Quality & Characteristics
Metric Availability by Platform

Universal availability: cost, clicks, impressions
Facebook-rich metrics: Detailed engagement and video completion data
TikTok video focus: Video-specific engagement metrics with 'p_' prefix for percentages
Google minimal: Primarily cost, clicks, impressions, conversions

Data Filtering Rules

Zero values excluded: Metrics with zero values are not stored to reduce table size
Null values excluded: Missing or null metrics are not inserted
Team requirement: Only accounts with assigned teams are included in final output

Platform-Specific Notes

TikTok aggregation: Ad-level data is summed to campaign level during processing
Video metrics: Facebook uses video_views_X format, TikTok uses video_views_p_X format
Currency consistency: All cost/revenue values in same currency units per account
Date consistency: All dates in consistent timezone (typically UTC)

Integration & Usage
Downstream Applications

BI Dashboards: Direct querying for real-time reporting
Scheduled Reports: Automated daily/weekly performance summaries
Data Exports: CSV/Excel generation for client deliverables
API Endpoints: Serve campaign data to applications
Alert Systems: Monitor performance thresholds and anomalies

Related Tables

clients_master.accounts: Account metadata, team assignments, platform identification
Source platform tables: Raw data from Facebook, Google, TikTok APIs
Custom aggregation tables: Pre-computed summaries for frequent queries

This unified structure enables comprehensive multi-platform campaign analysis while maintaining query performance and data consistency across all advertising platforms.